<!DOCTYPE html>
<html>
<head>
  <title>Register</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
  <script>
    window.onload = function() {
      const today = new Date();
      const maxDate = today.toISOString().split("T")[0];
      const minDate = new Date(today.getFullYear() - 130, today.getMonth(), today.getDate())
        .toISOString().split("T")[0];
      const dobInput = document.querySelector('input[name="date_of_birth"]');
      dobInput.setAttribute("max", maxDate);
      dobInput.setAttribute("min", minDate);
    };

    function validateForm() {
      const pw = document.getElementById("password").value;
      const confirmPw = document.getElementById("confirm_password").value;
      if (pw !== confirmPw) {
        alert("Passwords do not match. Please try again.");
        return false;
      }
      if (pw.length < 6) {
        alert("Password must be at least 6 characters long.");
        return false;
      }
      return true;
    }
  </script>
</head>
<body>
  <script type="module">
    import { createSidebar } from "{{ url_for('static', filename='navbar.js') }}";
    createSidebar("register");
  </script>

  <div class="content">
    <div class="container small">
      <h2>Create an Account üìù</h2>
      <p>Join us and start exploring your routes</p>

      {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          {% for category, message in messages %}
           <p class="flash-message flash-{{ category }}">
        {{ message }}
      </p>
          {% endfor %}
        {% endif %}
      {% endwith %}

      <form method="post" action="/register" onsubmit="return validateForm();">
        <label>Username</label>
        <input type="text" name="username" placeholder="Choose a username" required>

        <label>Email</label>
        <input type="email" name="email" placeholder="Enter your email" required>

        <label>Phone</label>
        <input type="text" name="phone" placeholder="Enter your phone number">

        <label>Password</label>
        <input type="password" name="password" id="password" placeholder="Create a password" required>

        <label>Confirm Password</label>
        <input type="password" name="confirm_password" id="confirm_password" placeholder="Re-enter your password" required>

        <label>Date of Birth</label>
        <input type="date" name="date_of_birth">

        <button type="submit">Register</button>
      </form>

      <p class="note">Already have an account? <a href="/login">Login here</a></p>
    </div>
  </div>
</body>
</html>